<!-- <div class="dashboard-root">
  <header class="navbar">
    <button class="menu-btn" (click)="toggleSidebar()" aria-label="menu">â˜°</button>
    <div class="brand">Doctor Dashboard</div>

    <div class="nav-right">
      <span class="doctor-name">Dr. {{ doctorName }}</span>
    </div>
  </header>

  
<div class="account-panel">
  <div class="panel-row">
    <div class="panel-item">
      <label>Account Status</label>
      <div class="status-pill" 
           [ngClass]="{ active: accountStatus === 'Active', inactive: accountStatus === 'Inactive' }">
        {{ accountStatus }}
      </div>
    </div>

    <div class="panel-item">
      <label>Current Status</label>

      
      <div class="inline" *ngIf="accountStatus === 'Active'; else inactiveBlock">
        <select [(ngModel)]="availability">
          <option *ngFor="let s of availabilityOptions" [value]="s">{{ s }}</option>
        </select>
        <button class="mini-btn" (click)="updateAvailability()">Update</button>
      </div>

      
      <ng-template #inactiveBlock>
        <span class="muted">--</span>
      </ng-template>
    </div>

    <div class="panel-item">
      <label>Shift</label>
      <span *ngIf="!loadingAllocations">{{ latestShift || 'â€”' }}</span>
      <span *ngIf="loadingAllocations">Loading...</span>
    </div>

    <div class="panel-item">
      <label>Room No.</label>
      <span *ngIf="!loadingAllocations">{{ latestRoom || 'â€”' }}</span>
      <span *ngIf="loadingAllocations">Loading...</span>
    </div>
  </div>
</div>
  <aside class="sidebar" [class.open]="sidebarOpen">
    <div class="sidebar-inner">
      <button class="close-btn" (click)="toggleSidebar()">âœ•</button>
      <nav class="sidebar-menu">
        <button (click)="viewAppointments()">View Appointments</button>
        <button (click)="viewHistory()">Appointments History</button>
        <button (click)="viewProfile()">View Profile</button>
        <button class="logout-btn" (click)="logout()">Logout</button>
      </nav>
    </div>
  </aside>

  <main class="content" [class.shifted]="sidebarOpen">
    <section class="today">
      <div class="content" *ngIf="currentView === 'appointments'">
        <h2>Scheduled Appointments</h2>
        <div *ngFor="let a of appointments" class="appointment" [class.past]="isPast(a.dateTime)">
          <div class="left">
            <div class="pname">{{ a.patientName }}</div>
            <div class="pid">ID: {{ a.patientId }}</div>
          </div>
          <div class="right">
            <div class="datetime">{{ formatDate(a.dateTime) }}</div>
            <div class="desc">{{ a.description }}</div>
            <div class="status" [class.consulted]="a.consulted">
              Status: {{ a.consulted ? 'Consulted' : 'Pending' }}
            </div>

            <div class="actions">
              <button *ngIf="!a.consulted" (click)="markConsulted(a)">Mark Consulted</button>
              <button (click)="openFollowUpForm(a.id)">Add Follow-up</button>
            </div>

            
            <div *ngIf="showFollowUpFormFor === a.id" class="followup-form">
              <input type="datetime-local" [(ngModel)]="newFollowUpDate" placeholder="Select date and time" />
              <div class="form-buttons">
                <button (click)="addFollowUp(a)">Save</button>
                <button class="cancel" (click)="cancelFollowUp()">Cancel</button>
              </div>
            </div>
          </div>
        </div>

        <div *ngIf="appointments.length === 0" class="no-app">No scheduled appointments.</div>
      </div>

      <div class="content" *ngIf="currentView === 'history'">
        <h2>Appointment History</h2>
        <div *ngFor="let a of historyAppointments" class="appointment-card consulted">
          <p><b>Patient:</b> {{ a.patientName }}</p>
          <p><b>Date:</b> {{ formatDate(a.dateTime) }}</p>
          <p><b>Description:</b> {{ a.description }}</p>
          <p><b>Status:</b> Consulted âœ…</p>
        </div>

        <div *ngIf="historyAppointments.length === 0" class="no-app">No appointments history.</div>
      </div>

      <div class="content" *ngIf="currentView === 'profile'">
        <app-doctor-profile></app-doctor-profile>
      </div>
    </section>
  </main>
</div> -->

<div class="dashboard-root">
  <header class="navbar">
    <button class="menu-btn" (click)="toggleSidebar()" aria-label="menu">â˜°</button>
    <div class="brand">Doctor Dashboard</div>

    <div class="nav-right">
      <span class="doctor-name">Dr. {{ doctorName }}</span>
    </div>
  </header>

  <!-- ðŸŒŸ Account & Availability Panel -->
  <!-- ðŸŒŸ Account & Availability Panel -->
<div class="account-panel">
  <div class="panel-row">
    <div class="panel-item">
      <label>Account Status</label>
      <div class="status-pill" 
           [ngClass]="{ active: accountStatus === 'Active', inactive: accountStatus === 'Inactive' }">
        {{ accountStatus }}
      </div>
    </div>

    <div class="panel-item">
      <label>Current Status</label>

      <!-- Only show dropdown if Active -->
      <div class="inline" *ngIf="accountStatus === 'Active'; else inactiveBlock">
        <select [(ngModel)]="availability">
          <option *ngFor="let s of availabilityOptions" [value]="s">{{ s }}</option>
        </select>
        <button class="mini-btn" (click)="updateAvailability()">Update</button>
      </div>

      <!-- When inactive -->
      <ng-template #inactiveBlock>
        <span class="muted">--</span>
      </ng-template>
    </div>

    <div class="panel-item">
      <label>Shift</label>
      <span *ngIf="!loadingAllocations">{{ latestShift || 'â€”' }}</span>
      <span *ngIf="loadingAllocations">Loading...</span>
    </div>

    <div class="panel-item">
      <label>Room No.</label>
      <span *ngIf="!loadingAllocations">{{ latestRoom || 'â€”' }}</span>
      <span *ngIf="loadingAllocations">Loading...</span>
    </div>
  </div>
</div>
  <aside class="sidebar" [class.open]="sidebarOpen">
    <div class="sidebar-inner">
      <button class="close-btn" (click)="toggleSidebar()">âœ•</button>
      <nav class="sidebar-menu">
        <button (click)="viewAppointments()">View Appointments</button>
        <button (click)="viewHistory()">Appointments History</button>
        <button (click)="viewProfile()">View Profile</button>
        <button class="logout-btn" (click)="logout()">Logout</button>
      </nav>
    </div>
  </aside>

  <main class="content" [class.shifted]="sidebarOpen">
    <section class="today">
      <div class="content" *ngIf="currentView === 'appointments'">
        <h2>Scheduled Appointments</h2>
        <div *ngFor="let a of appointments" class="appointment" [class.past]="isPast(a.dateTime)">
          <div class="left">
            <div class="pname">{{ a.patientName }}</div>
            <div class="pid">ID: {{ a.patientId }}</div>
          </div>
          <div class="right">
            <div class="datetime">{{ formatDate(a.dateTime) }}</div>
            <div class="desc">{{ a.description }}</div>
            <div class="status" [class.consulted]="a.consulted">
              Status: {{ a.consulted ? 'Consulted' : 'Pending' }}
            </div>

            <div class="actions">
              <button *ngIf="!a.consulted" (click)="markConsulted(a)">Mark Consulted</button>
              <button (click)="openFollowUpForm(a.id)">Add Follow-up</button>
            </div>

            <!-- Follow-up form -->
            <div *ngIf="showFollowUpFormFor === a.id" class="followup-form">
              <input type="datetime-local" [(ngModel)]="newFollowUpDate" placeholder="Select date and time" />
              <div class="form-buttons">
                <button (click)="addFollowUp(a)">Save</button>
                <button class="cancel" (click)="cancelFollowUp()">Cancel</button>
              </div>
            </div>
          </div>
        </div>

        <div *ngIf="appointments.length === 0" class="no-app">No scheduled appointments.</div>
      </div>

      <div class="content" *ngIf="currentView === 'history'">
        <h2>Appointment History</h2>
        <div *ngFor="let a of historyAppointments" class="appointment-card consulted">
          <p><b>Patient:</b> {{ a.patientName }}</p>
          <p><b>Date:</b> {{ formatDate(a.dateTime) }}</p>
          <p><b>Description:</b> {{ a.description }}</p>
          <p><b>Status:</b> Consulted âœ…</p>
        </div>

        <div *ngIf="historyAppointments.length === 0" class="no-app">No appointments history.</div>
      </div>

      <div class="content" *ngIf="currentView === 'profile'">
        <app-doctor-profile></app-doctor-profile>
      </div>
    </section>
  </main>
</div>